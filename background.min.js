importScripts("config.min.js"),chrome.tabs.onUpdated.addListener(async function(e,t,s){if("complete"===t.status&&s.url&&(chrome.storage.local.get(["systemUrl","puskesmasName"],function(e){const t=e.systemUrl,i=e.puskesmasName||"Unit Default";t&&s.url.startsWith(t)&&(s.url.includes("/visits")?chrome.scripting.executeScript({target:{tabId:s.id},files:["domHelpers.min.js","jquery-3.7.1.min.js","jquery-migrate.min.js","bardcode.min.js","base64.min.js","sprintf.min.js","jsLabel2PDF.min.js","content_script.min.js"]}).then(()=>{chrome.tabs.sendMessage(s.id,{type:"SET_PUSKESMAS_NAME",puskesmasName:i}).catch(e=>console.error("Failed to send message:",e))}).catch(e=>console.error("Failed to execute scripts:",e)):s.url.includes("/healthcenters/rekap_pemakaian_obat")?chrome.scripting.executeScript({target:{tabId:s.id},files:["domHelpers.min.js","jquery-3.7.1.min.js","resep.min.js"]}).catch(e=>console.error("Failed to execute scripts:",e)):s.url.includes(self.APP_CONFIG.API_DETAIL)&&chrome.scripting.executeScript({target:{tabId:s.id},files:["config.min.js","domHelpers.min.js","health_screening.min.js"]}).catch(e=>console.error("Failed to execute screening script:",e)))}),s.url&&(s.url.startsWith(self.APP_CONFIG.SCREENING_URL)||s.url.includes(self.APP_CONFIG.SCREENING_URL.replace("https://",""))))){const e=chrome.runtime.getURL("");chrome.storage.local.get(["health-screening-data"],t=>{const i=t["health-screening-data"]||null;console.log("Screening data from storage:",i),chrome.scripting.executeScript({target:{tabId:s.id},func:(e,t)=>{window.__APP_EXTENSION_URL__=e,window.__HEALTH_SCREENING_DATA__=t,console.log("Extension URL set:",e),console.log("Screening Data set:",t)},args:[e,i],world:"MAIN"}).then(()=>(console.log("Extension URL injected, now injecting ONNX Runtime..."),chrome.scripting.executeScript({target:{tabId:s.id},files:["ort.min.js"],world:"MAIN"}))).then(()=>(console.log("ONNX Runtime injected, now injecting solver..."),chrome.scripting.executeScript({target:{tabId:s.id},files:["config.min.js","captcha_solver.min.js"],world:"MAIN"}))).then(()=>(console.log("Solver injected, now injecting autofill..."),chrome.scripting.executeScript({target:{tabId:s.id},files:["health_screening_autofill.min.js"],world:"MAIN"}))).then(()=>{console.log("All CAPTCHA solver scripts injected successfully")}).catch(e=>console.error("Failed to execute solver scripts:",e))})}});