function waitForElm(t){return new Promise(e=>{const n=setInterval(function(){$(t).length&&(clearInterval(n),e(document.querySelector(t)))},10)})}window.sudah=!1,$(document).ready(()=>{const t=safeQuerySelector('input[update="view_pemakaian_obat"]');if(!t)return void console.warn("[resep.js] Submit button not found, medication statistics unavailable");const e=t.getAttribute("id");$(`#${e}`).on("click",async function(t){if(!window.sudah){window.sudah=!0;$("table.nested-table").length&&await waitForElm('#loading[style="margin: 0px 0px 10px 10px; display: none;"]'),await waitForElm("#view_pemakaian_obat");const t=await waitForElm("table.nested-table");if(t){const e=t.querySelectorAll("tr");for(let t=0;t<e.length;t++){const n=e[t];let l=document.getElementById(`org${t}`);l||(l=n.insertCell(4),l.setAttribute("id",`org${t}`),l.setAttribute("width","100"),l.style.color="#003399",l.style.textAlign="center",l.style.verticalAlign="inherit");let i=document.getElementById(`rat${t}`);i||(i=n.insertCell(5),i.setAttribute("id",`rat${t}`),i.setAttribute("width","100"),i.style.color="#003399",i.style.textAlign="center",i.style.verticalAlign="inherit");const o=n.querySelectorAll("a");if(o.length){for(const t of o){const e=t.getAttribute("href");e&&e.includes("pasien")&&$.ajax(e).done(t=>{if(!l.textContent.length&&t){const e=document.createElement("div");e.innerHTML=t;const o=e.querySelectorAll("tr"),a=document.createTextNode(""+(o.length-1));l.appendChild(a);const r=n.querySelectorAll("td"),c=Number(r[6].textContent.split(".").join("")),d=document.createTextNode(`${Math.ceil(c/(o.length-1))}`);i.appendChild(d)}})}window.sudah=!1}else if(!l.textContent.length){const t=document.createTextNode("Orang");l.appendChild(t);const e=document.createTextNode("Rata2");i.appendChild(e)}}}}return!1})});