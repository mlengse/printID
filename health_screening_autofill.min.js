!function(){"use strict";console.log("AutoFill (Page): Script dimuat");const e=window.__HEALTH_SCREENING_DATA__;function o(){if(!e)return void console.log("AutoFill (Page): No data available");console.log("AutoFill (Page): Data tersedia, mengisi form...");let o=0;const t=setInterval(()=>{o++;const l=document.querySelector("#nik_txt"),n=document.querySelector("#TglLahir_src");l&&n?(clearInterval(t),e.nik&&(l.value=e.nik,l.dispatchEvent(new Event("input",{bubbles:!0})),l.dispatchEvent(new Event("change",{bubbles:!0})),console.log("AutoFill (Page): NIK terisi")),e.tglLahir&&(n.value=e.tglLahir,n.dispatchEvent(new Event("input",{bubbles:!0})),n.dispatchEvent(new Event("change",{bubbles:!0})),console.log("AutoFill (Page): Tanggal Lahir terisi")),console.log("AutoFill (Page): Form berhasil diisi!")):o>=20&&(clearInterval(t),console.error("AutoFill (Page): Form elements tidak ditemukan"))},500)}const t=window.CaptchaSolver;if(!t)return console.error("AutoFill (Page): Solver tidak tersedia!"),void o();console.log("AutoFill (Page): Solver tersedia, memulai autofill...");let l=!1,n=null;async function i(){if(l)return void console.log("AutoFill (Page): CAPTCHA already solved, skipping...");console.log("AutoFill (Page): Mencari CAPTCHA elements...");let e=0;const o=setInterval(async()=>{e++;const s=document.querySelector("#AppCaptcha_CaptchaImage"),c=document.querySelector("#captchaCode_txt");if(console.log(`AutoFill (Page): Attempt ${e}/30`,{imgFound:!!s,inputFound:!!c}),s&&c){clearInterval(o),console.log("AutoFill (Page): CAPTCHA elements ditemukan!");try{if(!t.isReady()){console.log("AutoFill (Page): Initializing solver...");if(!await t.initialize())return void console.error("AutoFill (Page): Gagal initialize solver")}console.log("AutoFill (Page): Solving CAPTCHA...");const e=await t.solve(s);if(e&&5===e.length){console.log("AutoFill (Page): Typing CAPTCHA with keyboard events..."),c.focus(),c.value="";let o=0;const t=()=>{if(o<e.length){const l=e[o],n=l.charCodeAt(0);c.dispatchEvent(new KeyboardEvent("keydown",{key:l,code:"Key"+l.toUpperCase(),keyCode:n,which:n,bubbles:!0})),c.dispatchEvent(new KeyboardEvent("keypress",{key:l,code:"Key"+l.toUpperCase(),keyCode:n,which:n,charCode:n,bubbles:!0})),c.value+=l,c.dispatchEvent(new InputEvent("input",{inputType:"insertText",data:l,bubbles:!0})),c.dispatchEvent(new KeyboardEvent("keyup",{key:l,code:"Key"+l.toUpperCase(),keyCode:n,which:n,bubbles:!0})),o++,setTimeout(t,80+120*Math.random())}else c.dispatchEvent(new Event("change",{bubbles:!0})),console.log("AutoFill (Page): âœ… CAPTCHA solved:",e),a("success","CAPTCHA berhasil di-solve: "+e),setTimeout(()=>{const e=document.querySelector("#btnCariPetugas");e&&(console.log("AutoFill (Page): Focusing button and pressing Enter..."),e.focus(),e.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,which:13,bubbles:!0})),e.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter",code:"Enter",keyCode:13,which:13,bubbles:!0})),e.click(),a("info","Mencari peserta..."),l=!0,n&&(n.disconnect(),console.log("AutoFill (Page): Observer disconnected")),function(){console.log("AutoFill (Page): Watching for Setuju button or error modal...");const e=setInterval(()=>{const o=document.querySelectorAll('button, input[type="button"], a.btn');for(const t of o){const o=t.textContent||t.value||"";if(o.toLowerCase().includes("setuju"))return console.log("AutoFill (Page): Found Setuju button:",o),clearInterval(e),void setTimeout(()=>{t.focus(),t.click(),a("success","Klik Setuju..."),console.log("AutoFill (Page): Clicked Setuju button")},500)}const t=document.querySelectorAll('.modal, .swal2-container, [role="dialog"], .bootbox');for(const o of t){const t=o.textContent||"";if(t.toLowerCase().includes("captcha")&&(t.toLowerCase().includes("salah")||t.toLowerCase().includes("wrong"))){console.log("AutoFill (Page): Error modal detected - CAPTCHA salah"),clearInterval(e);const t=o.querySelectorAll('button, input[type="button"], .btn');for(const e of t){const o=e.textContent||e.value||"";if(o.toLowerCase().includes("ok")||o.toLowerCase().includes("tutup")||o.toLowerCase().includes("close")){console.log("AutoFill (Page): Clicking OK button..."),e.click();break}}return a("warning","CAPTCHA salah, mencoba lagi..."),void setTimeout(()=>{l=!1,n&&(n.observe(document.body,{childList:!0,subtree:!0}),console.log("AutoFill (Page): Observer re-enabled")),i()},1e3)}}const s=document.querySelector(".swal2-title, .bootbox-body, .modal-body");if(s){const o=s.textContent||"";if(o.toLowerCase().includes("captcha")&&(o.toLowerCase().includes("salah")||o.toLowerCase().includes("wrong"))){console.log("AutoFill (Page): SweetAlert error detected"),clearInterval(e);const o=document.querySelector(".swal2-confirm, .bootbox-accept, .btn-primary");return o&&o.click(),a("warning","CAPTCHA salah, mencoba lagi..."),void setTimeout(()=>{l=!1,n&&n.observe(document.body,{childList:!0,subtree:!0}),i()},1e3)}}},500);setTimeout(()=>{clearInterval(e),console.log("AutoFill (Page): Timeout waiting for response")},3e4)}())},300)};t()}else console.warn("AutoFill (Page): Invalid prediction:",e),a("warning","CAPTCHA prediction invalid")}catch(e){console.error("AutoFill (Page): Error solving CAPTCHA:",e),a("error","Error: "+e.message)}}else e>=30&&(clearInterval(o),console.log("AutoFill (Page): CAPTCHA elements tidak ditemukan setelah 15 detik"))},500)}function a(e,o){let t=document.getElementById("solver-notif");t||(t=document.createElement("div"),t.id="solver-notif",t.style.cssText="\n        position: fixed;\n        top: 10px;\n        right: 10px;\n        padding: 12px 20px;\n        border-radius: 5px;\n        z-index: 999999;\n        font-family: sans-serif;\n        font-size: 14px;\n        box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n      ",document.body.appendChild(t)),"success"===e?(t.style.backgroundColor="#d4edda",t.style.color="#155724"):"error"===e?(t.style.backgroundColor="#f8d7da",t.style.color="#721c24"):(t.style.backgroundColor="#fff3cd",t.style.color="#856404"),t.textContent=o,t.style.display="block",setTimeout(()=>{t.style.display="none"},5e3)}o(),i(),n=new MutationObserver(e=>{if(!l)for(const o of e)for(const e of o.addedNodes)if(e.nodeType===Node.ELEMENT_NODE&&("AppCaptcha_CaptchaImage"===e.id||e.querySelector?.("#AppCaptcha_CaptchaImage")))return console.log("AutoFill (Page): New CAPTCHA detected"),void setTimeout(i,500)}),n.observe(document.body,{childList:!0,subtree:!0})}();