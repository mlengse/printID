!function(){"use strict";const e=void 0!==window.APP_CONFIG?window.APP_CONFIG:{SCREENING_URL:"",API_VERIF:"",MSG_SCREENING:""};async function t(t){try{const o=(n=new Date,`${String(n.getDate()).padStart(2,"0")}-${String(n.getMonth()+1).padStart(2,"0")}-${n.getFullYear()}`),a=`${e.API_VERIF}${t}/${o}/001`;if("undefined"!=typeof $&&$.getJSON)return new Promise((e,t)=>{$.getJSON(a,function(t){e(t)}).fail(function(e,n,o){console.error("Error verifikasi (jQuery):",n,o),t(new Error(n))})});{const e=await fetch(a,{method:"GET",credentials:"same-origin",redirect:"follow",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return await e.json()}}catch(e){return console.error("Error verifikasi:",e),null}var n}function n(){const t=safeQuerySelector(".detail-container");if(!t)return!1;return(t.textContent||t.innerText).includes(e.MSG_SCREENING)}function o(e){const t=safeGetById("health-screening-loader-text");t&&(t.textContent=e)}function a(){const e=safeGetById("health-screening-loader");e&&e.remove()}async function r(){!function(){let e=safeGetById("health-screening-loader");if(e)return e;const t=document.createElement("div");t.id="health-screening-loader",t.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.7);\n      z-index: 9999;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column;\n    ";const n=document.createElement("div");n.style.cssText="\n      border: 8px solid #f3f3f3;\n      border-top: 8px solid #007bff;\n      border-radius: 50%;\n      width: 60px;\n      height: 60px;\n      animation: spin 1s linear infinite;\n    ";const o=document.createElement("div");o.id="health-screening-loader-text",o.textContent="Memuat data...",o.style.cssText="\n      color: white;\n      font-size: 16px;\n      margin-top: 20px;\n      font-family: Arial, sans-serif;\n      font-weight: bold;\n    ";const a=document.createElement("style");a.textContent="\n      @keyframes spin {\n        0% { transform: rotate(0deg); }\n        100% { transform: rotate(360deg); }\n      }\n    ",document.head.appendChild(a),t.appendChild(n),t.appendChild(o),document.body.appendChild(t)}(),o("Mengambil nomor...");const n=function(){const e=safeQuerySelector("span.nokartu");if(e){const t=e.textContent.trim().replace(/\s/g,"").replace(/&nbsp;/g,"");if(t)return t}const t=safeQuerySelectorAll(".input-static");for(const e of t){const t=safeQuerySelector("label",e);if(t){const n=t.textContent.trim();if("No. Kartu"===n||"No Kartu"===n){const t=safeQuerySelector("span",e);if(t){const e=t.textContent.trim().replace(/\s/g,"").replace(/&nbsp;/g,"");if(e)return e}}}}return console.error("ID tidak ditemukan dengan semua metode"),null}();if(!n)return console.error("Nomor tidak ditemukan"),o("Error: Nomor tidak ditemukan"),void setTimeout(a,2e3);o("Melakukan verifikasi...");const r=await t(n);if(r?o("Verifikasi berhasil, menyimpan data..."):(console.error("Gagal mendapatkan data verifikasi"),o("Gagal verifikasi, tetap membuka halaman...")),r&&"undefined"!=typeof chrome&&chrome.storage){const e={nik:r.noKTP||r.noKartu,tglLahir:r.tglLahir,nama:r.nama,timestamp:Date.now()};chrome.storage.local.set({"health-screening-data":e},function(){})}const i=e.SCREENING_URL;o("Membuka halaman...");const s=window.open(i,"HealthScreening","width=1200,height=800,left=100,top=100,resizable=yes,scrollbars=yes,status=yes");if(s)s.focus(),o("Menunggu halaman siap..."),setTimeout(function(){o("Halaman berhasil dibuka!"),setTimeout(a,1e3)},3e3);else{console.warn("Popup mungkin diblokir, mencoba membuka di tab baru..."),o("Popup diblokir, membuka tab baru...");const e=window.open(i,"_blank");e?(e.focus(),o("Tab berhasil dibuka!"),setTimeout(a,2e3)):(console.error("Gagal membuka window/tab. Popup mungkin diblokir oleh browser."),o("Error: Gagal membuka. Popup diblokir!"),setTimeout(a,3e3))}}function i(){const e=new MutationObserver(function(t){n()&&(r(),e.disconnect())});n()?r():(e.observe(document.body,{childList:!0,subtree:!0}),setTimeout(function(){e.disconnect()},1e4))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i()}();